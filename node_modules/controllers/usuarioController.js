console.log('CONTROLLERS CARGADAS -> OK');


//------------------------------------------------------------------------------------------------
// Recibe del cliente
//------------------------------------------------------------------------------------------------
io.sockets.on("connection",function(socket){

	//------------------------------------------------------------------------------------------------
	// LOGIN
	//------------------------------------------------------------------------------------------------
	socket.on("login",function( personaje ){

		pj = new User();
		pj.nombre = personaje.nombre;
		pj.posicionar();

		users[ pj.nombre ] = pj;

		console.log( users );

		// Nombro la conexion con su NOMBRE.
		socket.user = pj.nombre;

		// Login Success, devuelvo Objeto User con datos moldeados. (id asignado por ej.)
		socket.emit( "login_ok" , pj );

		// Aparece el User en el MUNDO.
		io.sockets.emit( "actualizar_users" , users );

	})



	//------------------------------------------------------------------------------------------------
	// KEYPRESSED controller
	//------------------------------------------------------------------------------------------------
	socket.on("keyPressed",function(character){

		id = socket.user;
		
	})

	//------------------------------------------------------------------------------------------------
	// LOGOUT
	//------------------------------------------------------------------------------------------------
	socket.on('disconnect', function (){

		delete users[ socket.user ]
		io.sockets.emit("actualizar_users",users)

	})
})